package com.library.management.model;

import java.util.Objects;

/**
 * Represents a book in the Library Management System.
 * <p>
 * This class holds information about each book including its title, author, genre, availability, and number of copies.
 * It is used for managing inventory, lending, and searching functionalities within the system.
 *
 * <p>Example usage:
 * <pre>
 *     Book book = new Book("1984", "George Orwell", "Dystopian", "1234567890", true, 5, 3);
 * </pre>
 *
 * @author Fardaws Jawad
 *
 * @see com.library.management.dao.BookDAO
 * @see com.library.management.model.Transaction
 */
public class Book {

    /** Unique identifier for the book (typically auto-generated by the database). */
    private int bookId;

    /** Title of the book. */
    private String title;

    /** Author of the book. */
    private String author;

    /** Genre or category the book belongs to (e.g., Fiction, Science, etc.). */
    private String genre;

    /** ISBN (International Standard Book Number) of the book. */
    private String isbn;

    /** Availability status of the book (true if available for borrowing). */
    private boolean isAvailable;

    /** Total number of copies of the book held in the library. */
    private int numberOfTotalCopies;

    /** Number of copies currently available for borrowing. */
    private int numberOfAvailableCopies;

    //-----------------------------------------------------------------------
    /**
     * Default no-argument constructor.
     * Useful for serialization, ORM frameworks, or manual property setting.
     */
    public Book() {
    }


    /**
     * Constructor with all attributes including bookId.
     * Typically used when retrieving full book records from the database.
     *
     * @param bookId               the unique ID of the book
     * @param title                the book title
     * @param author               the author of the book
     * @param genre                the genre of the book
     * @param isbn                 the ISBN number
     * @param isAvailable          availability status
     * @param numberOfTotalCopies total number of copies
     * @param numberOfAvailableCopies number of copies currently available
     */
    public Book(int bookId, String title, String author, String genre,
                String isbn, boolean isAvailable, int numberOfTotalCopies,
                int numberOfAvailableCopies) {

        this (title, author, genre, isbn, isAvailable, numberOfTotalCopies, numberOfAvailableCopies);
        this.bookId = bookId;
    }

    /**
     * Constructor without ID, for creating new book records before persisting to the database.
     *
     * @param title                the book title
     * @param author               the author of the book
     * @param genre                the genre of the book
     * @param isbn                 the ISBN number
     * @param isAvailable          availability status
     * @param numberOfTotalCopies total number of copies
     * @param numberOfAvailableCopies number of copies currently available
     */
    public Book(String title, String author, String genre, String isbn,
                boolean isAvailable, int numberOfTotalCopies,
                int numberOfAvailableCopies) {

        this.title = title;
        this.author = author;
        this.genre = genre;
        this.isbn = isbn;
        this.isAvailable = isAvailable;
        this.numberOfTotalCopies = numberOfTotalCopies;
        this.numberOfAvailableCopies = numberOfAvailableCopies;
    }

    /**
     * Partial constructor used when only basic details are needed.
     *
     * @param bookId  the unique ID of the book
     * @param title   the title of the book
     * @param author  the author of the book
     * @param genre   the genre of the book
     * @param isbn    the ISBN of the book
     */
    public Book(int bookId, String title, String author, String genre, String isbn) {
        this.bookId = bookId;
        this.title = title;
        this.author = author;
        this.genre = genre;
        this.isbn = isbn;
    }

    //-----------------------------------------------------------------------
    /** @return the book's unique ID */
    public int getBookId() {
        return bookId;
    }
    /** @param bookId sets the book's unique ID */
    public void setBookId(int bookId) {
        this.bookId = bookId;
    }

    /** @return the title of the book */
    public String getTitle() {
        return title;
    }

    /** @param title sets the title of the book */
    public void setTitle(String title) {
        this.title = title;
    }

    /** @return the author of the book */
    public String getAuthor() {
        return author;
    }

    /** @param author sets the author of the book */
    public void setAuthor(String author) {
        this.author = author;
    }

    /** @return the genre of the book */
    public String getGenre() {
        return genre;
    }

    /** @param genre sets the genre of the book */
    public void setGenre(String genre) {
        this.genre = genre;
    }

    /** @return the ISBN number of the book */
    public String getIsbn() {
        return isbn;
    }

    /** @param isbn sets the ISBN number of the book */
    public void setIsbn(String isbn) {
        this.isbn = isbn;
    }

    /** @return true if the book is available for borrowing */
    public boolean isAvailable() {
        return isAvailable;
    }

    /** @param available sets the availability of the book */
    public void setAvailable(boolean available) {
        isAvailable = available;
    }

    /** @return total number of copies of the book in the library */
    public int getNumberOfTotalCopies() {
        return numberOfTotalCopies;
    }

    /** @param numberOfTotalCopies sets the total number of book copies */
    public void setNumberOfTotalCopies(int numberOfTotalCopies) {
        this.numberOfTotalCopies = numberOfTotalCopies;
    }

    /** @return number of book copies currently available */
    public int getNumberOfAvailableCopies() {
        return numberOfAvailableCopies;
    }

    /** @param numberOfAvailableCopies sets the number of available copies */
    public void setNumberOfAvailableCopies(int numberOfAvailableCopies) {
        this.numberOfAvailableCopies = numberOfAvailableCopies;
    }

    //-----------------------------------------------------------------------
    /**
     * Returns a string representation of the book details.
     * Useful for debugging, logging, or display purposes.
     *
     * @return formatted string of book attributes
     */
    @Override
    public String toString() {
        return "Book Details:\n" +
                "  Book ID               : " + bookId + "\n" +
                "  Title                 : " + title + "\n" +
                "  Author                : " + author + "\n" +
                "  Genre                 : " + genre + "\n" +
                "  ISBN                  : " + isbn + "\n" +
                "  Available             : " + isAvailable + "\n" +
                "  Total Copies          : " + numberOfTotalCopies + "\n" +
                "  Available Copies      : " + numberOfAvailableCopies + "\n";
    }

    /**
     * Compares this book to another based on book ID.
     *
     * @param object the object to compare with
     * @return true if both have the same book ID, false otherwise
     */
    @Override
    public boolean equals(Object object) {
        if (this == object) return true;
        if (object == null || getClass() != object.getClass()) return false;
        Book book = (Book) object;
        return bookId == book.bookId;
    }


    /**
     * Generates a hash code based on the book ID.
     *
     * @return the hash code for the book
     */
    @Override
    public int hashCode() {
        return Objects.hashCode(bookId);
    }
}
